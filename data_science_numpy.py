# -*- coding: utf-8 -*-
"""Data Science: NumPy

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1TzctT0JZbVv1dz7ae4oeu2B-c3U2OMqU

### NumPy: an√°lise num√©rica eficiente com Python

### 1 - Conhecendo a biblioteca e nossos dados
"""

import numpy as np

url = 'https://raw.githubusercontent.com/alura-cursos/numpy/refs/heads/dados/apples_ts.csv'

dado = np.loadtxt(url,delimiter=',',usecols=np.arange(1,88,1))

7*12+3

np.arange(1,88,1)

"""As listas em Python s√£o estruturas de dados b√°sicas que podem conter elementos de diferentes tipos (inteiros, strings, outras listas, etc.). J√° a Numpy (Numerical Python) √© uma biblioteca do Python que fornece suporte a arrays multidimensionais, estruturas de dados mais avan√ßadas e eficientes para c√°lculos num√©ricos.

Aqui est√° um exemplo de como transformar uma lista em um array Numpy:
"""

import numpy as np

# cria uma lista
lista = [1, 2, 3, 4, 5]

# transforma a lista em um array Numpy
array = np.array(lista)

print("Lista: ", lista)
print("Array: ", array)

"""Existem v√°rias vantagens em usar arrays Numpy ao inv√©s de listas regulares do Python e aqui est√£o algumas:

Efici√™ncia de processamento
As opera√ß√µes matem√°ticas em arrays Numpy s√£o muito mais r√°pidas do que em listas regulares, pois a NumPy foi otimizada para trabalhar com conjuntos de dados homog√™neos e libera mem√≥ria do computador rapidamente.

Facilidade de uso
As opera√ß√µes matem√°ticas em arrays Numpy s√£o expressas de forma muito mais clara e concisa do que em listas regulares, tornando o c√≥digo mais f√°cil de ler e manter.

Integra√ß√£o com outras bibliotecas
A Numpy √© uma das bibliotecas mais utilizadas em ci√™ncia de dados e aprendizado de m√°quina. Muitas outras bibliotecas, como a Pandas e a Matplotlib, s√£o projetadas para trabalhar diretamente com arrays Numpy.

Comparativo de performance: listas vs arrays

Focando na efici√™ncia, podemos comparar o tempo levado para efetuar um c√°lculo utilizando listas e arrays.
"""

import numpy as np
import time

# cria uma lista com 1000000 elementos
lista = list(range(1000000))

# transforma a lista em um array Numpy
array = np.array(lista)

# come√ßa a cronometrar o tempo para a opera√ß√£o com a lista
start_time = time.time()

# realiza a opera√ß√£o de elevar ao quadrado cada elemento da lista
lista_quadrado = [i**2 for i in lista]

# para o cron√¥metro
list_time = time.time() - start_time

# come√ßa a cronometrar o tempo para a opera√ß√£o com o array
start_time = time.time()

# realiza a opera√ß√£o de elevar ao quadrado cada elemento do array
array_quadrado = array**2

# para o cron√¥metro
array_time = time.time() - start_time

print("Tempo da opera√ß√£o com a lista: ", list_time) #lista regular √© mais lenta
print("Tempo da opera√ß√£o com o array: ", array_time) # array numpy √© muito mais r√°pida

dado

dado.ndim # s√£o ou temos dados com duas dimens√µes

dado.size # numero/quantidados de dados

dado.shape # quer dizer que temos 6 linhas e 87 colunas

dado.T # transposi√ß√£o array: transforma as linhas em colunas

dado_transposto = dado.T

"""### Exemplo:
Um colega pediu para voc√™ carregar uma base de dados e verificar o n√∫mero de linhas e colunas do arquivo carregado. Ele estava com d√∫vidas se o n√∫mero total de linhas havia sido carregado.

Como determinar as dimens√µes corretas de um array?

Para responder essa pergunta voc√™ precisar√° do dataset. Voc√™ pode usar a op√ß√£o skiprows=1 para pular a primeira linha do arquivo.
"""

url = 'https://raw.githubusercontent.com/allanspadini/numpy/dados/bytebank.csv'
import numpy as np
dado1= np.loadtxt(url, delimiter=',',skiprows=1,dtype=float)
dado1.shape # O m√©todo .shape pode ser aplicado em um array para obter as suas dimens√µes.

url = 'https://raw.githubusercontent.com/allanspadini/numpy/dados/bytebank.csv'
import numpy as np
dado1= np.loadtxt(url, delimiter=',',skiprows=1,dtype=float)
np.shape(dado1)

"""### Teste Conhecimentos
Chegou a hora de voc√™ testar os conhecimentos desenvolvidos durante a aula. Para isso, vamos utilizar outro dataset em um desafio que ser√° desenvolvido no decorrer do curso. Esse dataset √© uma vers√£o modificada do arquivo Oranges vs. Grapefruit presente no site do Kaggle. Portanto, utilizaremos o arquivo raw dispon√≠vel no GitHub.

Nessa etapa, voc√™ deve efetuar a leitura dos dados. Para isso, importe a NumPy e use a fun√ß√£o loadtxt. Use o link da url e o par√¢metro usecols para pular a primeira coluna. √â poss√≠vel usar np.arange para criar a sequ√™ncia de n√∫meros que representam as colunas. Por fim, tamb√©m √© necess√°rio incluir o par√¢metro skiprows=1 para que a primeira linha de texto seja desconsiderada na leitura do arquivo.
"""

import numpy as np
url = 'https://raw.githubusercontent.com/allanspadini/numpy/dados/citrus.csv'
dado2 = np.loadtxt(url, delimiter=',',usecols=np.arange(1,6,1),skiprows=1)

dado2

dado2.T

"""### Resumo
Nessa aula, voc√™ aprendeu a:
Criar arrays com sequ√™ncias num√©ricas.
Carregar arquivos.
Verificar as dimens√µes de um array.
Realizar a transposi√ß√£o de um array.

### 2 - Explora√ß√£o dos dados
"""

datas = dado_transposto[:,0]

precos = dado_transposto[:,1:6]

import matplotlib.pyplot as plt # para gerar gr√°ficos

datas = np.arange(1,88,1)

plt.plot(datas, precos[:,0])

Moscow = precos[:,0]
Kaliningrad = precos[:,1]
Petersburg = precos[:,2]
Krasnodar = precos[:,3]
Ekaterinburg = precos[:,4]

Moscow

Moscow.shape

Moscow_ano1 = Moscow[0:12]
Moscow_ano2 = Moscow[12:24]
Moscow_ano3 = Moscow[24:36]
Moscow_ano4 = Moscow[36:48]

plt.plot(np.arange(1,13,1), Moscow_ano1)
plt.plot(np.arange(1,13,1), Moscow_ano2)
plt.plot(np.arange(1,13,1), Moscow_ano3)
plt.plot(np.arange(1,13,1), Moscow_ano4)
plt.legend(['ano1','ano2','ano3','ano4'])

np.array_equal(Moscow_ano1,Moscow_ano2) # verifica se dois array's s√£o iguais.

np.allclose(Moscow_ano1,Moscow_ano2, 0.01) # ir√° retornar True se a diferen√ßa entre os elementos do array for menor que o valor de 0.01 fornecido.

"""No decorrer deste curso, voc√™ pode notar uma certa similaridade dos n√∫meros e arrays com os escalares, vetores e matrizes da matem√°tica. Por isso, vamos falar um pouco sobre esses elementos.

Escalares

Os escalares s√£o n√∫meros simples utilizados na matem√°tica ou computa√ß√£o. S√£o n√∫meros que utilizamos em uma soma ou multiplica√ß√£o. Por exemplo, a temperatura de hoje √© 27 ¬∞C, ou o meu peso √© 70 kg.

Vetores

Em contraste, um vetor √© uma estrutura de dados que representa m√∫ltiplas quantidades relacionadas. Por exemplo, uma sequ√™ncia dos pesos dos boxeadores de uma determinada categoria. Nesse caso, um exemplo de vetor que representaria os pesos de quatro boxeadores seria esse: $(70.0,72.0,71.2,70.5)$. Outro uso comum para os vetores √© a representa√ß√£o da posi√ß√£o das coordenadas de um objeto no espa√ßo. No exemplo da figura abaixo temos o ponto A nas coordenadas (4,3). Os arrays da biblioteca Numpy s√£o prop√≠cios para guardarmos informa√ß√µes deste tipo.

Figura de um ponto A, em azul, no plano cartesiano.

Matrizes

Assim, como os vetores, as matrizes s√£o estruturas de dados que representam m√∫ltiplos valores relacionados. Uma tabela de dados pode ser representada por uma matriz. Aqui um exemplo de uma matriz com 3 linhas e 3 colunas:

Figura de uma matriz com tr√™s linhas e tr√™s colunas

Mas tamb√©m podemos ter matrizes 3D, ou com mais dimens√µes. No exemplo abaixo voc√™ pode ver uma matriz 3D.

Figura de uma matriz com 3 dimens√µes, representada por 3 matrizes, dispostas uma atr√°s da outra e vistas sob um √¢ngulo diagonal. Cada matriz √© uma matriz 3x3 que, juntas, formam a matriz de 3 dimens√µes.

Matrizes 3D possuem aplica√ß√µes mais avan√ßadas como o processamento de imagens, trabalho com anima√ß√µes e modelagem matem√°tica.

Um termo que voc√™ ir√° ouvir bastante neste curso √© ‚Äúdimens√µes‚Äù. Esse termo ser√° utilizado aqui para dizer em quantos eixos uma informa√ß√£o varia. Por exemplo, um vetor √© uma sequ√™ncia de valores, portanto, podemos dizer que varia em apenas uma dimens√£o, √© unidimensional. J√° uma matriz 2D, uma tabela de dados, possui linhas e colunas, por isso dizemos ser bidimensional.

O termo dimens√£o tamb√©m pode ser usado para se referir ao n√∫mero de linhas e colunas presentes em uma matriz. Podemos ter uma matriz com 5 linhas e 3 colunas. Eventualmente voc√™ pode ver o n√∫mero de linhas e colunas de uma matriz sendo mostrado no seu canto inferior direito. Sempre escrevemos primeiro o n√∫mero de linhas e posteriormente o n√∫mero de colunas. Esses n√∫meros s√£o importantes porque para opera√ß√µes de soma e multiplica√ß√£o, por exemplo, as dimens√µes das matrizes precisam ser compat√≠veis. S√≥ podemos somar matrizes com n√∫mero de linhas e colunas iguais. J√° para a multiplica√ß√£o ser poss√≠vel precisamos que o n√∫mero de colunas da primeira matriz seja igual ao n√∫mero de linhas da segunda.

### Exerc√≠cio
Patty √© uma cientista que est√° analisando uma base de dados. Ela est√° utilizando a biblioteca Numpy para avaliar as colunas de um array com dados de um sensor de calor. Cada coluna representa uma mesma informa√ß√£o coletada por um mesmo sensor em momentos diferentes. Para validar se o sensor continua calibrado, ela precisa que a diferen√ßa entre os valores nas posi√ß√µes de um array de nome `base` e uma coluna do array `medidas` sejam menores que 0.01.

Como ela pode utilizar a Numpy para fazer essa avalia√ß√£o sobre a coluna zero do array.

`np.allclose(base, medidas[:,0],0.01)`
"""

plt.plot(datas,Kaliningrad)

Kaliningrad  # NaN, um valor n√£o num√©rico, um tipo de erro que aparece qndo estamos trabalhando com matem√°tica

"""NaN, um valor n√£o num√©rico, um tipo de erro que aparece qndo estamos trabalhando com matem√°tica.


Verificando a quantidade de valores NaN
"""

sum(np.isnan(Kaliningrad))  # verifica valores n√£o num√©ricos

"""Ou:"""

np.sum(np.isnan(Kaliningrad))

"""Lidando com NaN"""

(Kaliningrad[3]+Kaliningrad[5])/2

Kaliningrad [4] = np.mean([Kaliningrad[3],Kaliningrad[5]])

"""Comparar dois arrays diferentes:"""

np.mean(Moscow)

np.mean(Kaliningrad)

"""###Exemplo:
Chegou a hora de voc√™ testar os conhecimentos desenvolvidos durante a aula. Continuando com o projeto das laranjas/toranjas agora voc√™ deve selecionar parte dos dados. As colunas que iremos avaliar s√£o as de di√¢metro e peso. Crie arrays espec√≠ficos para guardar o di√¢metro e peso da laranja e toranja. O di√¢metro est√° na coluna zero e o peso na coluna 1. Os dados referentes a laranja v√£o at√© a linha 4999 e os referentes √† toranja iniciam na linha 5000 do arquivo.

Ap√≥s fazer a sele√ß√£o de dados, importe a biblioteca matplotlib e crie um gr√°fico para a laranja e para a toranja do peso pelo di√¢metro.
"""

diametro_laranja = dado[:5000,0]
diametro_toranja = dado[5000:,0]
peso_laranja = dado[:5000,1]
peso_toranja = dado[5000:,1]

import matplotlib.pyplot as plt

plt.plot(diametro_laranja, peso_laranja)
plt.plot(diametro_toranja, peso_toranja)

"""### 3 - Opera√ß√µes entre arrays"""

plt.plot(datas, Moscow)

"""Regress√£o Linear: y=ax+b  

Equa√ß√£o da reta
"""

x = datas

y = 2*x+80

plt.plot(datas, Moscow)
plt.plot(x, y)

np.power(Moscow-y, 2) # Eleva um n√∫mero a uma pot√™ncia (quadrado)

np.sum(np.power(Moscow-y, 2)) # Somar todos os n√∫meros

np.sqrt(np.sum(np.power(Moscow-y, 2))) # Calcular a raiz

y = 0.52*x+80

plt.plot(datas, Moscow)
plt.plot(x, y)

np.sqrt(np.sum(np.power(Moscow-y, 2)))

np.linalg.norm(Moscow-y) # Calcula a norma de um vetor

Y = Moscow
X = datas
n = np.size(Moscow)

X**2

(X**2).shape

a = (n*np.sum(X*Y) - np.sum(X)*np.sum(Y))/(n*np.sum(X**2) - np.sum(X)**2)
a

b = np.mean(Y) - a*np.mean(X)
b

y = a*X+b

np.linalg.norm(Moscow-y)

"""### Exemplo:
Tha√≠s queria desenhar um c√≠rculo com a ajuda do computador. Para desenhar a parte superior do c√≠rculo ela sabia que deveria usar a equa√ß√£o:

y = sqrt(1 - x ^ 2)

E para a parte inferior bastava utilizar a mesma equa√ß√£o multiplicada por -1.

Qual sequ√™ncia de c√≥digo ela deve usar para construir o gr√°fico corretamente usando a Numpy e sabendo que ambas as partes do c√≠rculo devem ter a mesma cor?


Para desenhar um c√≠rculo, voc√™ precisa calcular a parte de cima e a parte de baixo. A parte de cima √© dada pela equa√ß√£o (y = \sqrt{1 - x^2}), que te d√° os valores de (y) para cada (x) na parte superior do c√≠rculo. Para a parte de baixo, voc√™ simplesmente multiplica essa equa√ß√£o por -1, resultando em (y = -\sqrt{1 - x^2}).

Ent√£o, voc√™ gera uma sequ√™ncia de valores de (x) que v√£o de -1 a 1. Para cada um desses valores de (x), voc√™ calcula (y) para a parte de cima e (y) para a parte de baixo. Depois, voc√™ plota ambas as partes no mesmo gr√°fico, usando a mesma cor para que pare√ßam uma √∫nica figura
"""

import numpy as np
import matplotlib.pyplot as plt

# Gerar uma sequ√™ncia de valores de x de -1 a 1
x1 = np.arange(-1, 1.01, 0.0001)

# Implementa√ß√£o da f√≥rmula
y1 = np.sqrt(1 - x1**2)
y2 = -np.sqrt(1 - x1**2)

# Plotar o gr√°fico com as duas partes do c√≠rculo
plt.plot(x1, y1, 'r')
plt.plot(x1, y2, 'r' )

# Adicionar o t√≠tulo do gr√°fico e os r√≥tulos dos eixos x e y
plt.title("C√≠rculo")
plt.xlabel("Eixo x1")
plt.ylabel("Eixo y")

# Exibir o gr√°fico
plt.show()

"""### Estimativa de valor"""

plt.plot(datas, Moscow)
plt.plot(X,y)
plt.plot(41.5,41.5*a+b,'*r')

plt.plot(datas, Moscow)
plt.plot(X,y)
plt.plot(41.5,41.5*a+b,'*r')
plt.plot(100,100*a+b,'*r')

"""### 4 - N√∫meros Aleat√≥rios"""

np.random.randint(low=40,high=100,size=100)

np.random.uniform(low=0.10,high=0.90,size=100) # Gera n√∫meros aleat√≥rios, sempre que rodamos o c√≥digo.

coef_angulares = np.random.uniform(low=0.10,high=0.90,size=100)

for i in range(100):
  print(np.linalg.norm(Moscow-(coef_angulares[i]*X+b)))

norma1 = np.array([])
for i in range(100):
    norma1 = np.append(norma1,np.linalg.norm(Moscow-(coef_angulares[i]*X+b))) # append: anexa valores ao finalde um array.

norma1

coef_angulares[1]

np.random.seed(16) # garante que os n√∫meros n√£o sejam aleat√≥rios
np.random.uniform(low=0.10,high=0.90,size=100)

np.random.seed(84)
coef_angulares = np.random.uniform(low=0.10,high=0.90,size=100)
norma1 = np.array([])
for i in range(100):
    norma1 = np.append(norma1,np.linalg.norm(Moscow-(coef_angulares[i]*X+b)))

norma1

coef_angulares

dados1 = np.column_stack([norma1, coef_angulares])

dados1.shape

np.savetxt('dados1.csv',dados1,delimiter=',') # cria um arquivo para fazer download

"""### Exemplo:

Claro! Vamos revisar os conceitos sobre a gera√ß√£o de n√∫meros aleat√≥rios com NumPy.Quando voc√™ utiliza a fun√ß√£o `np.random.uniform()`, ela gera n√∫meros aleat√≥rios dentro de um intervalo definido. No entanto, se voc√™ quiser garantir que a sequ√™ncia de n√∫meros gerados seja a mesma em diferentes execu√ß√µes, voc√™ deve usar a fun√ß√£o `np.random.seed()`. A semente (seed) √© um n√∫mero que inicializa o gerador de n√∫meros aleat√≥rios. Se voc√™ definir a mesma semente antes de gerar os n√∫meros, obter√° a mesma sequ√™ncia de resultados. Por exemplo:
Se voc√™ executar esse c√≥digo v√°rias vezes, sempre obter√° o mesmo array.Agora, se voc√™ reiniciar a semente antes de gerar novos n√∫meros, como no caso do c√≥digo da M√°rcia, ela acabar√° gerando a mesma sequ√™ncia de n√∫meros para ambas as vari√°veis a e b. Isso significa que a e b ser√£o id√™nticos, o que n√£o √© o que ela deseja.Pense em como voc√™ poderia ajustar o c√≥digo dela para gerar duas sequ√™ncias diferentes. Que tal tentar mudar a semente antes de gerar a segunda sequ√™ncia? Isso pode ser uma boa solu√ß√£o! üòä
"""

import numpy as np

np.random.seed(42)
a = np.random.uniform(0, 1, 5)
np.random.seed(42)
b = np.random.uniform(0, 1, 5)

print("Sequ√™ncia 1 de a:", a)
print("Sequ√™ncia 1 de b:", b)
# A sequ√™ncia de c√≥digo vai gerar 5 n√∫meros entre 0 e 1. Al√©m disso, o seed(42) vai fazer com que as duas sequ√™ncias sejam iguais.

"""O primeiro valor dentro do `random.uniform` √© o primeiro valor poss√≠vel na sequ√™ncia, o segundo valor √© o √∫ltimo valor poss√≠vel e o √∫ltimo √© o n√∫mero de valores na sequ√™ncia. Al√©m disso, colocar o `random.seed` com o mesmo n√∫mero logo antes da chamada da fun√ß√£o faz com que seja gerada a mesma sequ√™ncia. Um exemplo de c√≥digo que resolveria o problema corretamente √© este, repare que ser√£o geradas sequ√™ncia de 5 n√∫meros:"""

import numpy as np

np.random.seed(42)
a = np.random.uniform(0, 5, 5)
np.random.seed(8)
b = np.random.uniform(0, 5, 5)

print("Sequ√™ncia 1 de a:", a)
print("Sequ√™ncia 1 de b:", b)

"""### Exemplo 2:
Voc√™ come√ßou os seus estudos com a biblioteca Numpy e resolveu utiliz√°-la para substituir um c√°lculo que estava sendo realizado com listas do Python. A lista que voc√™ tem em m√£os √© igual a:
"""

xx = [0,1,2,3,4,5,6,7,8,9,10]

"""Essa lista estava sendo utilizada para calcular os diversos valores de `y` na equa√ß√£o `y = x + 3 / 2`. Como ficaria o c√≥digo em Numpy para substituir o seguinte trecho de c√≥digo?"""

xx = [0,1,2,3,4,5,6,7,8,9,10]
yy = []

for i in xx:
  yy.append(i + 3 / 2)
  print(yy)
  print(xx)

print(yy)
print(xx)

import numpy as np

xx = np.array([0,1,2,3,4,5,6,7,8,9,10])  # Transformando a lista em um array NumPy
yy = xx + 3 / 2  # Opera√ß√£o vetorizada, sem loop

print(yy)